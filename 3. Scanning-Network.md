

## Module 3 : Scaninng Network

## 1. Intro Scanning Network
- Sau khi qúa trình thu nhập thông tin Footprinting , chúng ta có thể đã đủ thông tin về mục tiêu. Vì việc việc dò tìm trong network của mục tiêu là mục đích tiếp theo để quá trình tấn công có thể đi xa hơn. Quá trình Scan Network nhằm các mục đích chủ yếu sau :
	- Xác định các hosts sống trên network
	- Xác định các cổng đóng và mở
	- Xác định thêm các thông tin về Opera System
	- Xác định các dịch vụ đang chạy trên network
	- Xác định được trong network có sử dụng thiết bị kiểm soát lưu lượng mạng như là firewall
	- Xác định được xác điểm yếu có thể dễ tấn công
	- Xác định kiến trúc hệ thống 

## 2. Overvivew of Network Scanning 

- Gói (packet) là đơn vị thông tin cơ bản truyền qua tất cả các mạng máy tính hiện đại, và trong cả các mạng viễn thông khác. Gói có thể có kích thước cố định hoặc thay đổi, tùy thuộc vào hình thức mạng và giao thức (hay là một định dạng thống nhất). Mỗi gói, dù có kích thước nào, đều không chỉ chứa dữ liệu mà còn có cả tiêu đề (header) trong đó có địa chỉ IP nguồn và đích.

Nếu lớn hơn MTU, thông điệp sẽ được chia thành các gói nhỏ hơn trước khi gửi đi. Việc chia ra sẽ làm chậm tốc độ truyền tải. Lý tưởng nhất thì MTU nên bằng MTU nhỏ nhất trong tất cả các mạng kết nối giữa máy tính và máy tính đích mà thông điệp được gửi đến.

- TCP Communication
	- Lưu lượng IP ( Internet Protocol ) gồm có 2 kiểu : TCP ( Transmission Controll Protocol ) và UDP ( User Datagram Protocol ) . TCP thiết lập chắn chắn ( quá trình bắt tay 3 bước )trước khi truyền dữ liệu , so với UDP chỉ đơn giản truyền dữ liệu, không quan tâm dữ liệu từ nguồn có đến được đích hay không . 
![](https://s3-ap-southeast-1.amazonaws.com/kipalog.com/Screenshot%20from%202015-10-05%2011%3A26%3A49.png_hg7lxko7qw)

TCP header flag gồm 9 bit. Gồm 6 flags
	![](https://slideplayer.com/slide/9035057/27/images/20/TCP+Header+Flags+Six+TCP+flags%3A.jpg)

- Trường Sequence và Acknowledgement là hai trong nhiều tính năng giúp chúng ta xếp loại TCP là giao thức có định hướng kết nối. Như vậy, dữ liệu được gởi qua kết nối của TCP thì chúng giúp các máy ở xa theo dõi kết nối đó và đảm bảo rằng không một gói tin nào bị mất trên đường đi tới đích của nó.

- TCP sử dụng các gói báo nhận tích cực, thời gian chờ, và truyền lại để đảm bảo việc chuyển dữ liệu của người dùng không bị lỗi, có đánh số thứ tự. Số sequence sẽ được chia thành 2 loại
	- Nếu SYN bằng 1 , thì số sequence là số thứ tự ban đầu, thực chất số này sẽ là data của byte đầu tiên. Và gía trị của acknowledged sẽ là giá trị sequence + 1
	- Nếu SYN bằng 0 , thì sequence sẽ là data của byte tầu tiên trong session này .

- Custom TCP Flag with nping
	Nping has a very flexible and powerful command-line interface that grants users full control over generated packets. Nping's features include:
	-   Custom TCP, UDP, ICMP and ARP packet generation.
	-   Support for multiple target host specification.
	-   Support for multiple target port specification.
	-   Unprivileged modes for non-root users.
	-   [Echo mode](http://nmap.org/book/nping-man-echo-mode.html)  for advanced troubleshooting and discovery.
	-   Support for Ethernet frame generation.
	-   Support for IPv6 (currently experimental).
	-   Runs on Linux, Mac OS and MS Windows.
	-   Route tracing capabilities.
	-   Highly customizable.
	-   Free and open-source.


## 3. Các phương pháp Network Scan

- Bao gồm các giao đoạn  sau :
	- Kiểm tra state hệ thống và các host
	- Phát hiện các cổng đang mở
	- Quyét vượt qua các hệ thống phòng ngờ chống xâm nhập .
	- Thu nhập các thông tin về các dịch vụ và  các hệ điều hành và dịch vụ đang chạy 
	- Quyét các điểm yếu
	- Biểu đồ mạng
	- Proxy.

### 3.1 . Checking for Live System

- ICMP Scaning : Sử dụng các câu lệnh để kiểm tra ICMP echo reply. Sử dụng nmap : `nmap -sn 192.168.88.11-255`
- Ping Sweep : Sử dụng các câu lệnh để kiểm tra ICMP echo tới một IP address range 

### 3.2. Check for Open Port 

- SSDP Scaning - Simple Service Discovery Protocol 
### Scanning Tool
 
NMAP :
	- ping : `nmap -sP -v [i]`
	- host , port, service discovery : `nmap -O [ip]`

Hping3 : Usefull for test firewall, advance port scanning, testing net performance,  MUT,  traceroute. 

Done
